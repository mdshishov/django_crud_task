{% extends 'base.html' %}

{% block title %}Библиотека – «{{ book.title }}»{% endblock %}

{% block content %}
  <h1>Информация о книге</h1>
  <a href="{% url 'book_list' %}">Вернуться</a>

  <p><b>Название:</b> «{{ book.title }}»</p>
  <p><b>ISBN:</b> {{ book.isbn }} </p>
  <p><b>Автор:</b> {{ book.author }} </p>
  {% if book.co_authors %}
  <p><b>Соавторы:</b> {{ book.co_authors }}</p>
  {% endif %}
  <p><b>Жанры:</b> {{ book.genres }} </p>
  <p><b>Год издания:</b> {{ book.publication_year }} </p>
  {% if book.summary %}
  <p><b>Описание:</b> {{ book.summary }} </p>
  {% endif %}

  <a href="./edit"><button type="button">Изменить</button></a>
  <button type="button" onclick="deleteBook({{ book_id }})">Удалить</button>

  <script>
    function deleteBook(bookId) {
      if (confirm('Вы уверены, что хотите удалить книгу «{{ book.title }}»?')) {
        fetch(window.location.href, {
          method: 'DELETE',
          headers: {
            'Content-Type': 'application/json',
          },
        })
        .then(response => {
          if (response.ok) {
            alert('Книга «{{ book.title }}» успешно удалена!');
            window.location.href = "{% url 'book_list' %}";
          } else {
            alert('Произошла ошибка!');
          }
        });
      }
    }
  </script>
{% endblock %}